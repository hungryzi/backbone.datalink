/*
Backbone DataLink Library v0.2
Copyright 2012, Pascal Hartig
Dual licensed under the MIT or GPL Version 3 licenses.
*/(function(a,b){return typeof exports!="undefined"?b(a,exports,require("synapse")):typeof define=="function"&&define.amd?define("datalink",["synapse","exports"],function(c,d){return b(a,d,c)}):a.DataLink=b(a,{},a.Synapse)})(this,function(a,b,c){var d;return d=function(a){if(a.model==null)throw new Error("View "+a.toString()+" must be bound to a model!")},{version:"0.2",defaultOptions:{bind:"syncWith",attribute:"data-bind",ignoreEmpty:!1,prefill:!0,triggerOnBind:!1},linkView:function(a,b,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t;k=_.defaults(e||{},this.defaultOptions),d(a),o=new c(a.model),q={triggerOnBind:k.triggerOnBind},j=function(a){return o.observe(a,q).notify(a,q)},p=function(b,c){var d,e;if((c!=null?c.prefill:void 0)===!1)return;if(!k.prefill&&(c!=null?c.prefill:void 0)!==!0)return;return d=b.hook.detectOtherInterface(b.raw),e=b.hook.detectInterface(b.raw),b.hook.setHandler(b.raw,e,a.model.get(d)),b.set(d,b)},h=function(a,b){var d,e,f,g;return(d=b!=null?b.bind:void 0)?f=d:f=k.bind,f==="syncWith"?e=j:e=o[f],g=new c(a),p(g,b),e.call(o,g)},i=function(a,b){if(!a.length){if((b!=null?b.ignoreEmpty:void 0)===!0)return;if(!k.ignoreEmpty&&(b!=null?b.ignoreEmpty:void 0)!==!1)throw new Error("No matching element found\nfor selector "+selector+"!")}},m=function(b,c){var d,e,f;return e=(c!=null?c.attribute:void 0)||k.attribute,f="["+e+"="+b+"]",d=a.$(f),i(d,c),d},t=[];for(r=0,s=b.length;r<s;r++)l=b[r],n=f!=null?f[l]:void 0,g=m(l,n),t.push(h(g,n));return t}}});